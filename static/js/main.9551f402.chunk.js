(this["webpackJsonpchoral-tracks"]=this["webpackJsonpchoral-tracks"]||[]).push([[0],{20:function(e,t,n){},24:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(6),i=n.n(a),o=n(2),s=(n(20),n(10)),l=n.n(s),u=(n(23),n(24),n(1));var d=function(e){return Object(u.jsx)("button",{className:function(){var t=e.selected?" selected":"";return"full-choir"===e.role?"PreferenceBtn full-choir"+t:"PreferenceBtn"+t}(),onClick:function(){e.handler(e.part),e.setSelectedPreference({role:e.role,part:e.part})},children:e.content})};n(26);var f=function(e){var t=Object(r.useState)({role:"full-choir",part:null}),n=Object(o.a)(t,2),c=n[0],a=n[1],i=function(e,t){return"full-choir"===c.role&&"full-choir"===e||c.role===e&&c.part===t};return Object(u.jsxs)("div",{className:"Preferences",style:{gridTemplateColumns:"repeat (".concat(e.parts.length,", auto)")},children:[Object(u.jsx)("span",{children:"Emphasize"}),e.parts.map((function(t){return Object(u.jsx)(d,{part:t,content:e.initials[t],role:"emphasize",handler:e.emphasizePart,selected:i("emphasize",t),setSelectedPreference:a},"emphasize-".concat(t))})),Object(u.jsx)("span",{children:"Isolate"}),e.parts.map((function(t){return Object(u.jsx)(d,{part:t,content:e.initials[t],role:"isolate",handler:e.isolatePart,selected:i("isolate",t),setSelectedPreference:a},"isolate-".concat(t))})),Object(u.jsx)("div",{className:"full-choir-container",style:{gridColumn:"2 / ".concat(e.parts.length+2)},children:Object(u.jsx)(d,{onClick:e.fullChoir,selected:i("full-choir"),role:"full-choir",content:"Full Choir",handler:e.fullChoir,setSelectedPreference:a})})]})};n(27);var j=function(e){var t=Object(r.useState)(0),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(0),s=Object(o.a)(i,2),l=s[0],d=s[1],f=Object(r.useRef)();return Object(r.useEffect)((function(){var e=window.getComputedStyle(f.current).getPropertyValue("width");d(parseInt(e.slice(0,3)))}),[]),Object(r.useEffect)((function(){var t=e.timestamp/e.duration*l;a(t)}),[e.timestamp]),Object(u.jsx)("div",{className:"ProgressMeter",ref:f,onClick:function(t){var n=t.target.getBoundingClientRect(),r=(t.clientX-n.x)/l*e.duration;e.seekTrack(r)},children:Object(u.jsx)("div",{className:"progress-bar",style:{width:c}})})},h=n(13),b=n.n(h),p=n(11),O=n.n(p),m=n(14),g=n.n(m);n(28);var x=function(e){var t=function(t){32===t.keyCode&&e.pauseTrack()};return Object(u.jsxs)("div",{className:"Controls",children:[Object(u.jsx)("button",{className:"control-btn",onClick:e.resetTrack,children:Object(u.jsx)(g.a,{})}),e.playing?Object(u.jsx)("button",{className:"control-btn",onClick:e.pauseTrack,onKeyUp:t,children:Object(u.jsx)(O.a,{})}):Object(u.jsx)("button",{className:"control-btn",onClick:e.playTrack,children:Object(u.jsx)(b.a,{})}),Object(u.jsx)("div",{className:"progress-meter-container",children:Object(u.jsx)(j,{seekTrack:e.seekTrack,duration:e.duration,timestamp:e.timestamp})})]})};n(34);var v=function(e){var t=Object(r.useState)(1e4),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(0),s=Object(o.a)(i,2),d=s[0],j=s[1],h=Object(r.useState)(!1),b=Object(o.a)(h,2),p=b[0],O=b[1],m=Object(r.useState)(!0),g=Object(o.a)(m,2),v=g[0],k=g[1],y=Object(r.useState)(!1),N=Object(o.a)(y,2),T=N[0],S=N[1],w=Object(r.useRef)({data:{},gainNodes:{},sourceNodes:{},loaded:{}}),C=Object(r.useRef)({ctx:new(window.AudioContext||window.webkitAudioContext),time:0}),E=Object(r.useRef)(),P=function(){return Object.values(w.current.loaded).length===e.parts.length},B=function(){p||(e.parts.forEach((function(e){!function(e){w.current.data[e].then((function(t){var n=C.current.ctx.createBufferSource();w.current.sourceNodes[e]=n,n.buffer=t,n.connect(w.current.gainNodes[e]),w.current.gainNodes[e].connect(C.current.ctx.destination),n.start(0,d)}))}(e)})),O(!0))},I=function(){p&&(e.parts.forEach((function(e){w.current.sourceNodes[e].stop()})),O(!1))},z=function(){I(),j(0)};return Object(r.useEffect)((function(){T&&(B(),S(!1))}),[T]),Object(r.useEffect)((function(){e.parts.forEach((function(t){w.current.data[t]=function(t){var n=new Request("./tracks/".concat(e.location,"/").concat(t,".mp3"));return fetch(n).then((function(e){return e.arrayBuffer()})).then((function(e){return C.current.ctx.decodeAudioData(e,(function(e){return w.current.loaded[t]=!0,console.log(t,"loaded"),P()&&k(!1),e}))}))}(t),w.current.gainNodes[t]=C.current.ctx.createGain()})),Object.values(w.current.data)[0].then((function(e){return a(e.duration)}))}),[]),Object(r.useEffect)((function(){return p?(C.current.previousTime=C.current.ctx.currentTime,E.current=setInterval((function(){var e=C.current.ctx.currentTime-C.current.previousTime;C.current.previousTime=C.current.ctx.currentTime,j((function(t){return t+e}))}),250)):clearInterval(E.current),function(){return clearInterval(E.current)}}),[p]),Object(r.useEffect)((function(){d>c&&z()}),[d]),Object(u.jsxs)("div",{className:"Song",children:[Object(u.jsx)("h2",{className:"song-title",children:e.title}),Object(u.jsx)("span",{className:"loading-message",children:v?"Loading song (this might take a bit)":""}),Object(u.jsxs)(l.a,{loading:v,children:[Object(u.jsx)(x,{playTrack:B,resetTrack:z,pauseTrack:I,seekTrack:function(e){p&&S(!0),I(),j(e)},timestamp:d,duration:c,playing:p}),Object(u.jsx)("span",{className:"parts",children:"Parts: ".concat(e.parts.map((function(e){return e.charAt(0)+e.slice(1)})).join(", "))}),Object(u.jsx)(f,{parts:e.parts,initials:e.initials,emphasizePart:function(t){e.parts.forEach((function(e){w.current.gainNodes[e].gain.value=e===t?1:.1}))},isolatePart:function(t){e.parts.forEach((function(e){w.current.gainNodes[e].gain.value=e===t?1:0}))},fullChoir:function(){e.parts.forEach((function(e){return w.current.gainNodes[e].gain.value=1}))}})]})]})};n(35);var k=function(e){return Object(u.jsx)("button",{className:"SongBtn",onClick:function(){e.setSelectedSong(e.id)},children:e.title})};var y=function(){var e=Object(r.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("h1",{children:"Holy Transfiguration Choir"}),Object(u.jsxs)("section",{id:"overview",children:[Object(u.jsx)("p",{children:'Welcome to the HT choral resources! Hopefully, there will be a lot more to come, but for right now, check out the song player below. If you click on one of the titles, you can play the song with options to hear your part by itself ("isolate"), or with the other parts softer ("emphasize").'}),Object(u.jsx)("p",{id:"disclaimer",children:'NB: \u2002 This player ain\'t gonna work on a mobile device. \xa0 Also, you may find that you get the best experience using headphones, especially when selecting "emphasize".'})]}),[{location:"it_is_truly_meet_3",title:"It Is Truly Meet #3",parts:["melody","tenor","bass"],initials:{melody:"M",tenor:"T",bass:"B"},id:1},{location:"ascension-megalonarion",title:"Ascension Megalonarion",parts:["soprano","alto","tenor","bass"],initials:{soprano:"S",alto:"A",tenor:"T",bass:"B"},id:2}].map((function(e){return function(e){return e.id===n?Object(u.jsx)(v,{location:e.location,title:e.title,parts:e.parts,initials:e.initials},e.id):Object(u.jsx)(k,{title:e.title,id:e.id,setSelectedSong:c},e.title+e.id)}(e)}))]})};i.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(y,{})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.9551f402.chunk.js.map